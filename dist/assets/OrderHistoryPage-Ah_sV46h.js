import{u as x,j as e,L as m,A as h}from"./index-ByxEemcU.js";import{r as n}from"./vendor-CIP6LD3P.js";const p=s=>new Date(s).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}),g=s=>{switch(s){case"Livrée":return"bg-green-100 text-green-800";case"En cours d'expédition":return"bg-blue-100 text-blue-800";case"En attente":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},u=({item:s})=>e.jsxs("div",{className:"py-4 flex items-center space-x-4",children:[e.jsx(h,{product:s,loading:"lazy",className:"w-16 h-16 rounded-md object-cover flex-shrink-0"}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("p",{className:"font-semibold text-gray-800",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.quantity," x ",s.price.toFixed(2)," €"]})]}),e.jsxs("p",{className:"font-semibold text-gray-900",children:[(s.quantity*s.price).toFixed(2)," €"]})]}),j=({order:s})=>{const[t,r]=n.useState(!1);return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"p-4 sm:p-6 grid grid-cols-2 sm:grid-cols-4 gap-4 items-center cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>r(!t),"aria-expanded":t,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Commande"}),e.jsx("p",{className:"font-bold text-teal-600",children:s.id})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Date"}),e.jsx("p",{className:"font-semibold text-gray-700",children:p(s.date)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Statut"}),e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${g(s.status)}`,children:s.status})]}),e.jsxs("div",{className:"flex items-center justify-between sm:justify-end",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Total"}),e.jsxs("p",{className:"font-bold text-gray-900",children:[s.total.toFixed(2)," €"]})]}),e.jsx("svg",{className:`w-5 h-5 text-gray-500 ml-4 transform transition-transform ${t?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]})]}),t&&e.jsx("div",{className:"p-4 sm:p-6 border-t border-gray-200 bg-gray-50/50",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2 text-gray-800",children:"Détails de la commande"}),e.jsx("div",{className:"divide-y divide-gray-200",children:s.items.map(a=>e.jsx(u,{item:a},a.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2 text-gray-800",children:"Informations de livraison"}),s.shippingDetails.type==="pickup"&&s.shippingDetails.pickupPoint?e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Livraison en point de retrait"}),e.jsxs("div",{className:"text-gray-600 mt-1 pl-4 border-l-2",children:[e.jsx("p",{className:"font-bold",children:s.shippingDetails.pickupPoint.name}),e.jsx("p",{children:s.shippingDetails.address.line1}),e.jsxs("p",{children:[s.shippingDetails.address.postalCode," ",s.shippingDetails.address.city]})]})]}):e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Livraison à domicile"}),e.jsxs("div",{className:"text-gray-600 mt-1 pl-4 border-l-2",children:[e.jsx("p",{children:s.shippingDetails.address.name}),e.jsx("p",{children:s.shippingDetails.address.line1}),e.jsxs("p",{children:[s.shippingDetails.address.postalCode," ",s.shippingDetails.address.city]}),s.carrierDetails&&e.jsxs("p",{className:"mt-2 pt-2 border-t text-xs",children:["Transporteur: ",s.carrierDetails.name]})]})]})]})]})})]})},v=({onBack:s})=>{const{token:t}=x(),[r,a]=n.useState([]),[o,l]=n.useState(!0);return n.useEffect(()=>{(async()=>{if(!t){l(!1);return}l(!0);try{const i=await fetch("/api/orders",{headers:{Authorization:`Bearer ${t}`}});if(!i.ok)throw new Error("Failed to fetch orders");const c=await i.json();a(c)}catch(i){console.error("Failed to load orders from API",i),a([])}finally{l(!1)}})()},[t]),e.jsx("div",{className:"bg-gray-50 min-h-screen animate-fade-in",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center mb-8 pb-4 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-extrabold text-gray-900 flex items-center gap-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-teal-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),"Mon Historique de Commandes"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Retrouvez ici le suivi de toutes vos commandes passées."})]}),e.jsx("button",{onClick:s,className:"mt-4 sm:mt-0 text-sm bg-white text-gray-700 font-semibold py-2 px-4 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors self-start sm:self-center",children:"← Retour à la boutique"})]}),o?e.jsx("div",{className:"text-center py-20",children:e.jsx(m,{})}):r.length>0?e.jsx("div",{className:"space-y-4",children:r.map(d=>e.jsx(j,{order:d},d.id))}):e.jsxs("div",{className:"text-center py-20 bg-white border border-gray-200 rounded-lg",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"mx-auto h-20 w-20 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 12l8 4 8-4"})]}),e.jsx("h3",{className:"mt-4 text-xl font-semibold text-gray-800",children:"Aucune commande pour le moment"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Passez votre première commande pour la voir apparaître ici."}),e.jsx("button",{onClick:s,className:"mt-6 px-6 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors font-semibold",children:"Commencer vos achats"})]})]})})};export{v as default};
